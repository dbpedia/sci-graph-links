Abstract In the smart city construction, massive data collected from various fields need to be outsourced to the cloud for convenience and resource saving. However, integrity and confidentiality of the data in cloud remains a challenge issue due to the loss of data possession. As a solution, some public data auditing schemes have been proposed in last several years. Most recently, Li et al. proposed an efficient public auditing scheme and claimed that it could reduce the cost of clients on generating verification metadata. In this paper, we analyze the security of Li et al.’s scheme and point out two weaknesses in it. We demonstrate that it cannot achieve the confidentiality for outsourced data and it is vulnerable to the proof forgery attack. To address these weaknesses, we propose an improved public auditing scheme, which can not only preserve the data privacy but also resist the proof forgery attack. Security analysis shows that our scheme is provably secure in a robust security model. Performance analysis shows that the proposed scheme can overcome the weaknesses in Li et al.’s scheme at the cost of increasing computation overhead slightly.