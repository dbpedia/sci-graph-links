Abstract In geostatistics, the approximation of the spatial dependence structure of a process, through the estimation of the variogram or the covariogram of the variable under consideration, is an important issue. In this work, under a general spatial model, including a mean or trend function, and without assuming any parametric model for this function and for the dependence structure of the process, a general nonparametric estimator of the variogram is proposed. The new approach consists in applying an iterative algorithm, using the residuals obtained from a nonparametric local linear estimation of the trend function, jointly with a correction of the bias due to the use of these residuals. A simulation study checks the validity of the presented approaches in practice. The broad applicability of the procedures is demonstrated on a real data set.