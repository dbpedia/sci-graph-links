Abstract The Fully Implicit method (FIM) is often the method of choice for the temporal discretization of the partial differential equations governing multiphase flow in porous media. The FIM involves solving large coupled systems of nonlinear algebraic equations. Newton-based methods, which are employed to solve the nonlinear systems, can suffer from convergence problems—this is especially true for large time steps in the presence of highly nonlinear flow physics. To overcome such convergence problems, the time step is usually reduced, and the Newton steps are restarted from the solution of the previous (converged) time step. Recently, potential ordering and the reduced-Newton method were used to solve immiscible three-phase flow in the presence of buoyancy and capillary effects (e.g., Kwok and Tchelepi, J. Comput. Phys. 227(1), 706–727 2007). Here, we improve the robustness of the potential-based ordering method in the presence of gravity. Furthermore, we also extend this nonlinear approach to interphase mass transfer. Our algorithm deals effectively with mass transfer between the liquid and gas phases, including phase disappearance (e.g., gas going back in solution) and reappearance (e.g., gas coming out of solution and forming a separate phase), as a function of pressure and composition. Detailed comparisons of the robustness and efficiency of the potential-based solver with state-of-the-art nonlinear/linear solvers are presented for immiscible two-phase (Dead-Oil), Black-Oil, and compositional problems using heterogeneous models. The results show that for large time steps, our nonlinear ordering-based solver reduces the number of nonlinear iterations significantly, which leads to gains in the overall computational cost.
