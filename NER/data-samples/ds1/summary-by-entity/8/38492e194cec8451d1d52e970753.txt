Abstract Internal users are the main causes of anomalous and suspicious behaviors in a communication network. Even when traditional security middleboxes are present, internal attacks may lead the network to outages or to leakage of sensitive information. In this article, we propose BroFlow, an Intrusion Detection and Prevention System based on Bro traffic analyzer and on the global network view of the software-defined networks (SDN) which is provided by the OpenFlow. BroFlow main contributions are (i) dynamic and elastic resource provision of traffic-analyzing machines under demand; (ii) real-time detection of DoS attacks through simple algorithms implemented in a policy language for network events; (iii) immediate reaction to DoS attacks, dropping malicious flows close of their sources, and (iv) near-optimal placement of sensors through a proposed heuristic for strategically positioning sensors in the network infrastructure, which is shared by multi-tenants, with a minimum number of sensors. We developed a prototype of the proposed system, and we evaluated it in a virtual environment of the Future Internet Testbed with Security (FITS). An evaluation of the system under attack shows that BroFlow guarantees the forwarding of legitimate packets at the maximal link rate, reducing up to 90 % of the maximal network delay caused by the attack. BroFlow reaches 50 % of bandwidth gain when compared with conventional firewalls approaches, even when the attackers are legitimate tenants acting in collusion. In addition, the system reduces the sensors number, while keeping full coverage of network flows.
network             0.999999999965894^^http://www.w3.org/2001/XMLSchema#double            http://dbpedia.org/resource/Computer_network      

bandwidth                     0.9999976570272956^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Bandwidth_(computing) 

OpenFlow                      1.0^^http://www.w3.org/2001/XMLSchema#double                          http://dbpedia.org/resource/OpenFlow              

SDN                           0.9999991129959039^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Software-defined_networking

network                       0.999999999965894^^http://www.w3.org/2001/XMLSchema#double            http://dbpedia.org/resource/Computer_network      

network delay                 1.0^^http://www.w3.org/2001/XMLSchema#double                          http://dbpedia.org/resource/Network_delay         

Future Internet               1.0^^http://www.w3.org/2001/XMLSchema#double                          http://dbpedia.org/resource/Future_Internet       

DoS attacks                   1.0^^http://www.w3.org/2001/XMLSchema#double                          http://dbpedia.org/resource/Denial-of-service_attack

sensors                       0.9999997893731001^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Sensor                

collusion                     0.9999985404630671^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Collusion             

heuristic                     0.9997211251937611^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Heuristic             

firewalls                     1.0^^http://www.w3.org/2001/XMLSchema#double                          http://dbpedia.org/resource/Firewall_(computing)  

sensors                       0.9999997893731001^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Sensor                

language                      0.9999999010010518^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Programming_language  

communication network         1.0^^http://www.w3.org/2001/XMLSchema#double                          http://dbpedia.org/resource/Telecommunications_network

software-defined              1.0^^http://www.w3.org/2001/XMLSchema#double                          http://dbpedia.org/resource/Software-defined_radio

DoS attacks                   1.0^^http://www.w3.org/2001/XMLSchema#double                          http://dbpedia.org/resource/Denial-of-service_attack

algorithms                    1.0^^http://www.w3.org/2001/XMLSchema#double                          http://dbpedia.org/resource/Algorithm             

network                       0.999999999965894^^http://www.w3.org/2001/XMLSchema#double            http://dbpedia.org/resource/Computer_network      

elastic                       0.6841104564640539^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Elasticity_(economics)

FITS                          0.9999999960068635^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/FITS                  

network                       0.999999999965894^^http://www.w3.org/2001/XMLSchema#double            http://dbpedia.org/resource/Computer_network      

network                       0.999999999965894^^http://www.w3.org/2001/XMLSchema#double            http://dbpedia.org/resource/Computer_network      

real-time                     0.9999998383175484^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Real-time_computing   

infrastructure                0.9999999999797637^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Cloud_computing       

prototype                     0.9996621571018008^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Prototype             

packets                       0.9911418032235091^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Network_packet        

virtual environment           0.9989124823273992^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Virtualization        

sensors                       0.9999997893731001^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Sensor                

sensors                       0.9999997893731001^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Sensor                

Intrusion Detection           1.0^^http://www.w3.org/2001/XMLSchema#double                          http://dbpedia.org/resource/Intrusion_detection_system

