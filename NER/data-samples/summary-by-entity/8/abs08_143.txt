Abstract BackgroundIt is extremely common to need to select a subset of reads from a BAM file based on their specific properties. Typically, a user unpacks the BAM file to a text stream using SAMtools, parses and filters the lines using AWK, then repacks them using SAMtools. This process is tedious and error-prone. In particular, when working with many columns of data, mix-ups are common and the bit field containing the flags is unintuitive. There are several libraries for reading BAM files, such as Bio-SamTools for Perl and pysam for Python. Both allow access to the BAMâ€™s read information and can filter reads, but require substantial boilerplate code; this is high overhead for mostly ad hoc filtering. ResultsWe have created a query language that gathers reads using a collection of predicates and common logical connectives. Queries run faster than equivalents and can be compiled to native code for embedding in larger programs. ConclusionsBAMQL provides a user-friendly, powerful and performant way to extract subsets of BAM files for ad hoc analyses or integration into applications. The query language provides a collection of predicates beyond those in SAMtools, and more flexible connectives.
BAM                 0.99638367855202^^http://www.w3.org/2001/XMLSchema#double             http://dbpedia.org/resource/Brooklyn_Academy_of_Music

BAM                           0.99638367855202^^http://www.w3.org/2001/XMLSchema#double             http://dbpedia.org/resource/Brooklyn_Academy_of_Music

subset                        0.9999238563880802^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Subset                

SAMtools                      0.9999999963218897^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/SAMtools              

subsets                       0.9996298357391467^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Subset                

Perl                          1.0^^http://www.w3.org/2001/XMLSchema#double                          http://dbpedia.org/resource/Perl                  

AWK                           1.0^^http://www.w3.org/2001/XMLSchema#double                          http://dbpedia.org/resource/AWK                   

flags                         0.9999999998974545^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Flag_word             

predicates                    0.9941211326401799^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Predicate_(mathematical_logic)

ad hoc                        0.9991351506458996^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Ad_hoc                

stream                        0.9999999999791953^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Stream_(computing)    

SAMtools                      0.9999999963218897^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/SAMtools              

SAMtools                      0.9999999963218897^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/SAMtools              

columns                       0.9999999810876263^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Column_(database)     

predicates                    0.9941211326401799^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Predicate_(mathematical_logic)

BAM                           0.99638367855202^^http://www.w3.org/2001/XMLSchema#double             http://dbpedia.org/resource/Brooklyn_Academy_of_Music

logical connectives           1.0^^http://www.w3.org/2001/XMLSchema#double                          http://dbpedia.org/resource/Logical_connective    

filter                        0.999980331878685^^http://www.w3.org/2001/XMLSchema#double            http://dbpedia.org/resource/Filter_(software)     

bit field                     1.0^^http://www.w3.org/2001/XMLSchema#double                          http://dbpedia.org/resource/Bit_field             

query language                1.0^^http://www.w3.org/2001/XMLSchema#double                          http://dbpedia.org/resource/Query_language        

filters                       0.9999835325833893^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Filter_(software)     

libraries                     0.9999999999990905^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Library_(computing)   

BAM                           0.99638367855202^^http://www.w3.org/2001/XMLSchema#double             http://dbpedia.org/resource/Brooklyn_Academy_of_Music

boilerplate code              1.0^^http://www.w3.org/2001/XMLSchema#double                          http://dbpedia.org/resource/Boilerplate_code      

ad hoc                        0.9991351506458996^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Ad_hoc                

embedding                     0.9999999948403229^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Portable_Document_Format

connectives                   1.0^^http://www.w3.org/2001/XMLSchema#double                          http://dbpedia.org/resource/Logical_connective    

query language                1.0^^http://www.w3.org/2001/XMLSchema#double                          http://dbpedia.org/resource/Query_language        

native code                   0.9999996427199632^^http://www.w3.org/2001/XMLSchema#double           http://dbpedia.org/resource/Machine_code          

BAM                           0.99638367855202^^http://www.w3.org/2001/XMLSchema#double             http://dbpedia.org/resource/Brooklyn_Academy_of_Music

Python                        1.0^^http://www.w3.org/2001/XMLSchema#double                          http://dbpedia.org/resource/Python_(programming_language)

