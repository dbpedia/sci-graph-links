Abstract The relative importance of resource heterogeneity and quantity on plant diversity is an ongoing debate among ecologists, but we have limited knowledge on relationships between tree diversity and heterogeneity in soil nutrient availability in tropical forests. We expected tree species richness to be: (1) positively related to vertical soil nutrient heterogeneity; (2) negatively related to mean soil nutrient availability; and (3) more influenced by nutrient availability in the upper than lower soil horizons. Using a data set from 60, 20 × 40-m plots in a moist forest, and 126 plots in miombo woodlands in Tanzania, we regressed tree species richness against vertical soil nutrient heterogeneity, both depth-specific (0–15, 15–30, and 30–60 cm) and mean soil nutrient availability, and soil physical properties, with elevation and measures of anthropogenic disturbance as co-variables. Overall, vertical soil nutrient heterogeneity was the best predictor of tree species richness in miombo but, contrary to our prediction, the relationships between tree species richness and soil nutrient heterogeneity were negative. In the moist forest, mean soil nutrient availability explained considerable variations in tree species richness, and in line with our expectations, these relationships were mainly negative. Soil nutrient availability in the top soil layer explained more of the variation in tree species richness than that in the middle and lower layers in both vegetation types. Our study shows that vertical soil nutrient heterogeneity and mean availability can influence tree species richness at different magnitudes in intensively utilized tropical vegetation types.