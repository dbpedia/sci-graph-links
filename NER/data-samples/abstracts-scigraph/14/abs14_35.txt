Abstract This paper deals with estimation of a production technology where endogeneous choice of input and output variables is explicitly recognized. In particular, we assume that producers maximize return to the outlay (RO). For simplicity and tractability we start with a Cobb–Douglas transformation function with multiple inputs and outputs and show how the first-order conditions of RO maximization can be used to derive an estimating equation which is nothing but a partial input productivity equation. This equation does not suffer from the econometric endogeneity problem although the output and input variables are endogenous. First, we consider the case where producers are fully efficient allocatively but technically inefficient. The model is estimated using a single equation stochastic frontier approach. The model is then extended to allow allocative inefficiency and it is estimated as a system using generalized method of moment. Algebraic expressions are derived to decompose the effect of technical and allocative inefficiencies on RO. We also consider translog specifications that are estimated as (1) a single equation frontier model as well as (2) a system. We use a panel of Norwegian fishing trawlers data to estimate the model. Outputs are different species caught while inputs are labor and vessel size. We also control for number of days of operation, age of the vessel and year effects. Empirical results show that the average rate of RO is reduced by about 20 to 30 % due to technical inefficiency. On the other hand, average allocative efficiency is found to be about 78 %. The average overall efficiency is found to be around 60 %.