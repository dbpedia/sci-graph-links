<annotation text="Abstract AbstractFingerprint similarity is a common method for comparing chemical structures. Similarity is an appealing approach because, with many fingerprint types, it provides intuitive results: a chemist looking at two molecules can understand why they have been determined to be similar. This transparency is partially lost with the fuzzier similarity methods that are often used for scaffold hopping and tends to vanish completely when molecular fingerprints are used as inputs to machine-learning (ML) models. Here we present similarity maps, a straightforward and general strategy to visualize the atomic contributions to the similarity between two molecules or the predicted probability of a ML model. We show the application of similarity maps to a set of dopamine D3 receptor ligands using atom-pair and circular fingerprints as well as two popular ML methods: random forests and naÃ¯ve Bayes. An open-source implementation of the method is provided. ">
  <surfaceForm name="determined" offset="268">
    <resource label="Determinism" uri="Determinism" contextualScore="0.7843508484670095" percentageOfSecondRank="0.0025384121904403045" support="1145" priorScore="9.524135431841686E-6" finalScore="0.9974673337221582" types=""/>
  </surfaceForm>
  <surfaceForm name="popular" offset="853">
    <resource label="Pop music" uri="Pop_music" contextualScore="0.06144824102945889" percentageOfSecondRank="0.07673157945418935" support="17762" priorScore="1.4774471051560875E-4" finalScore="0.3173021901219059" types="DBpedia:TopicalConcept, DBpedia:Genre, DBpedia:MusicGenre"/>
    <resource label="Popular culture" uri="Popular_culture" contextualScore="0.6316908874766444" percentageOfSecondRank="0.4879721204255324" support="3019" priorScore="2.511210905565943E-5" finalScore="0.6502465547523595" types=""/>
  </surfaceForm>
  <surfaceForm name="models" offset="510">
    <resource label="Statistical model" uri="Statistical_model" contextualScore="0.9683045673787312" percentageOfSecondRank="0.07032116846607646" support="441" priorScore="3.6682477951460117E-6" finalScore="0.9260336150591225" types=""/>
  </surfaceForm>
  <surfaceForm name="application" offset="724">
    <resource label="Computer program" uri="Computer_program" contextualScore="0.9934224544392023" percentageOfSecondRank="0.05530294205722911" support="2681" priorScore="2.230061754826861E-5" finalScore="0.9073546165209727" types=""/>
  </surfaceForm>
  <surfaceForm name="We" offset="712">
    <resource label="Montana" uri="Montana" contextualScore="0.41884174430913546" percentageOfSecondRank="0.024327440519919006" support="14470" priorScore="1.203617813962875E-4" finalScore="0.390865093789783" types="Schema:Place, DBpedia:Place, DBpedia:PopulatedPlace, DBpedia:Region, Schema:AdministrativeArea, DBpedia:AdministrativeRegion"/>
    <resource label="South Africa" uri="South_Africa" contextualScore="0.4974500261982549" percentageOfSecondRank="0.6518797298531606" support="56069" priorScore="4.6638318736063884E-4" finalScore="0.5995969438685069" types="Schema:Place, DBpedia:Place, DBpedia:PopulatedPlace, Schema:Country, DBpedia:Country"/>
  </surfaceForm>
  <surfaceForm name="transparency" offset="299">
    <resource label="Transparency and translucency" uri="Transparency_and_translucency" contextualScore="0.9661099896669011" percentageOfSecondRank="0.0020241700629834063" support="1035" priorScore="8.609152988607987E-6" finalScore="0.9969214701075799" types=""/>
  </surfaceForm>
  <surfaceForm name="implementation" offset="920">
    <resource label="Implementation" uri="Implementation" contextualScore="0.4404429522466597" percentageOfSecondRank="0.032739393841302034" support="371" priorScore="3.0859862403609303E-6" finalScore="0.9682975639246064" types=""/>
  </surfaceForm>
  <surfaceForm name="molecules" offset="658">
    <resource label="Molecule" uri="Molecule" contextualScore="0.9936641513141725" percentageOfSecondRank="6.846501632040944E-7" support="6324" priorScore="5.260317246372648E-5" finalScore="0.9999993152815775" types=""/>
  </surfaceForm>
  <surfaceForm name="atomic" offset="607">
    <resource label="Atom" uri="Atom" contextualScore="0.9516097335232628" percentageOfSecondRank="0.0012167850366851" support="5661" priorScore="4.708832373769064E-5" finalScore="0.9987846868073814" types=""/>
  </surfaceForm>
  <surfaceForm name="Abstract" offset="0">
    <resource label="Abstraction" uri="Abstraction" contextualScore="0.9972753981561329" percentageOfSecondRank="0.0047597986281077784" support="626" priorScore="5.207081904220869E-6" finalScore="0.9949030168377818" types=""/>
  </surfaceForm>
  <surfaceForm name="visualize" offset="593">
    <resource label="Information visualization" uri="Information_visualization" contextualScore="0.9999808919226131" percentageOfSecondRank="6.035273013571041E-6" support="164" priorScore="1.364155642639333E-6" finalScore="0.9999890483166499" types=""/>
  </surfaceForm>
  <surfaceForm name="fingerprint" offset="149">
    <resource label="Fingerprint" uri="Fingerprint" contextualScore="0.24108171779201745" percentageOfSecondRank="5.101290846302015E-4" support="845" priorScore="7.028728768477052E-6" finalScore="0.9993835302604538" types=""/>
  </surfaceForm>
  <surfaceForm name="This" offset="294">
    <resource label="Breast" uri="Breast" contextualScore="0.9949726770551516" percentageOfSecondRank="1.4207775438646083E-4" support="3027" priorScore="2.5178653233349152E-5" finalScore="0.9997504536379238" types="DBpedia:AnatomicalStructure"/>
  </surfaceForm>
  <surfaceForm name="common" offset="45">
    <resource label="Grammatical gender" uri="Grammatical_gender" contextualScore="0.3369280545210915" percentageOfSecondRank="0.08308656940429572" support="2228" priorScore="1.853255348658801E-5" finalScore="0.2341559035700465" types=""/>
    <resource label="Common law" uri="Common_law" contextualScore="0.5953719217233767" percentageOfSecondRank="0.3277581533188994" support="5578" priorScore="4.639792789415975E-5" finalScore="0.7144167161029231" types=""/>
  </surfaceForm>
  <surfaceForm name="maps" offset="750">
    <resource label="Function (mathematics)" uri="Function_(mathematics)" contextualScore="0.9999970753661522" percentageOfSecondRank="8.219226106873457E-7" support="11138" priorScore="9.264613138851763E-5" finalScore="0.9999991760073483" types=""/>
  </surfaceForm>
  <surfaceForm name="fingerprints" offset="453">
    <resource label="Cryptographic hash function" uri="Cryptographic_hash_function" contextualScore="0.9993468304913699" percentageOfSecondRank="0.05713216187416136" support="494" priorScore="4.10910297234043E-6" finalScore="0.9448566260417547" types=""/>
  </surfaceForm>
  <surfaceForm name="Here" offset="518">
    <resource label="Black metal" uri="Black_metal" contextualScore="0.39546772906180383" percentageOfSecondRank="0.06322797048835256" support="3407" priorScore="2.8339501673611023E-5" finalScore="0.4503674270939825" types="DBpedia:TopicalConcept, DBpedia:Genre, DBpedia:MusicGenre"/>
    <resource label="Death metal" uri="Death_metal" contextualScore="0.4453197546681801" percentageOfSecondRank="0.8642096504262989" support="3501" priorScore="2.9121395761465274E-5" finalScore="0.5211321429607091" types="DBpedia:TopicalConcept, DBpedia:Genre, DBpedia:MusicGenre"/>
  </surfaceForm>
  <surfaceForm name="molecules" offset="224">
    <resource label="Molecule" uri="Molecule" contextualScore="0.9936641513141725" percentageOfSecondRank="6.846501632040944E-7" support="6324" priorScore="5.260317246372648E-5" finalScore="0.9999993152815775" types=""/>
  </surfaceForm>
  <surfaceForm name="molecular" offset="443">
    <resource label="Molecule" uri="Molecule" contextualScore="0.4230760947411996" percentageOfSecondRank="7.134820182351927E-4" support="6324" priorScore="5.260317246372648E-5" finalScore="0.9992866168402351" types=""/>
  </surfaceForm>
  <surfaceForm name="lost" offset="325">
    <resource label="Lost film" uri="Lost_film" contextualScore="2.1368550697833423E-4" percentageOfSecondRank="5.624225274868889E-4" support="2109" priorScore="1.7542708843453375E-5" finalScore="0.2902561954201654" types=""/>
    <resource label="Packet loss" uri="Packet_loss" contextualScore="0.9991455581205252" percentageOfSecondRank="0.40919830226050175" support="97" priorScore="8.068481544878982E-7" finalScore="0.7093289337143535" types=""/>
  </surfaceForm>
  <surfaceForm name="ML" offset="861">
    <resource label="ML (programming language)" uri="ML_(programming_language)" contextualScore="0.9970789167035435" percentageOfSecondRank="3.571304635353677E-5" support="154" priorScore="1.2809754205271786E-6" finalScore="0.9999636976781566" types="Schema:CreativeWork, DBpedia:Work, DBpedia:Software, DBpedia:ProgrammingLanguage"/>
  </surfaceForm>
  <surfaceForm name="chemical structures" offset="73">
    <resource label="Chemical structure" uri="Chemical_structure" contextualScore="0.9999999998451585" percentageOfSecondRank="1.749506809324496E-13" support="535" priorScore="4.450141883000263E-6" finalScore="0.9999999999997726" types=""/>
  </surfaceForm>
  <surfaceForm name="method" offset="52">
    <resource label="Scientific method" uri="Scientific_method" contextualScore="0.9952945146026833" percentageOfSecondRank="0.003866067755301264" support="1645" priorScore="1.3683146537449409E-5" finalScore="0.9941236815452231" types=""/>
  </surfaceForm>
  <surfaceForm name="model" offset="705">
    <resource label="Mathematical model" uri="Mathematical_model" contextualScore="0.026700764242175903" percentageOfSecondRank="0.10239464978274238" support="1147" priorScore="9.540771476264116E-6" finalScore="0.1924368648712938" types=""/>
    <resource label="Statistical model" uri="Statistical_model" contextualScore="0.9700787190971129" percentageOfSecondRank="0.24448051311178676" support="441" priorScore="3.6682477951460117E-6" finalScore="0.7871255766847297" types=""/>
  </surfaceForm>
  <surfaceForm name="method" offset="942">
    <resource label="Scientific method" uri="Scientific_method" contextualScore="0.9952945146026833" percentageOfSecondRank="0.003866067755301264" support="1645" priorScore="1.3683146537449409E-5" finalScore="0.9941236815452231" types=""/>
  </surfaceForm>
  <surfaceForm name="maps" offset="545">
    <resource label="Function (mathematics)" uri="Function_(mathematics)" contextualScore="0.9999970753661522" percentageOfSecondRank="8.219226106873457E-7" support="11138" priorScore="9.264613138851763E-5" finalScore="0.9999991760073483" types=""/>
  </surfaceForm>
  <surfaceForm name="open-source" offset="908">
    <resource label="Open source" uri="Open_source" contextualScore="0.9824301454805743" percentageOfSecondRank="9.483395164780307E-4" support="6065" priorScore="5.044880471102168E-5" finalScore="0.9990477203516583" types=""/>
  </surfaceForm>
  <surfaceForm name="ML" offset="702">
    <resource label="ML (programming language)" uri="ML_(programming_language)" contextualScore="0.9970789167035435" percentageOfSecondRank="3.571304635353677E-5" support="154" priorScore="1.2809754205271786E-6" finalScore="0.9999636976781566" types="Schema:CreativeWork, DBpedia:Work, DBpedia:Software, DBpedia:ProgrammingLanguage"/>
  </surfaceForm>
  <surfaceForm name="chemist" offset="201">
    <resource label="Chemistry" uri="Chemistry" contextualScore="0.011644528836035787" percentageOfSecondRank="0.014883765049334875" support="9350" priorScore="7.777350767486442E-5" finalScore="0.9782150436120545" types=""/>
  </surfaceForm>
  <surfaceForm name="circular" offset="816">
    <resource label="Circle" uri="Circle" contextualScore="0.49164849021190626" percentageOfSecondRank="0.0037813176229507936" support="3466" priorScore="2.8830264984072733E-5" finalScore="0.995422138504036" types=""/>
  </surfaceForm>
  <surfaceForm name="strategy" offset="581">
    <resource label="Strategy (game theory)" uri="Strategy_(game_theory)" contextualScore="0.5728102233840193" percentageOfSecondRank="9.636832872381666E-4" support="542" priorScore="4.508368038478771E-6" finalScore="0.10190833971072083" types=""/>
    <resource label="Strategy" uri="Strategy" contextualScore="0.42578325166245806" percentageOfSecondRank="0.11348590304433764" support="1501" priorScore="1.2485351339034383E-5" finalScore="0.8979823658882672" types=""/>
  </surfaceForm>
  <surfaceForm name="methods" offset="358">
    <resource label="Scientific method" uri="Scientific_method" contextualScore="0.9952945148218585" percentageOfSecondRank="0.005966206393071742" support="1645" priorScore="1.3683146537449409E-5" finalScore="0.9907181147817515" types=""/>
  </surfaceForm>
  <surfaceForm name="naÃ¯ve Bayes" offset="892">
    <resource label="Naive Bayes classifier" uri="Naive_Bayes_classifier" contextualScore="1.0" percentageOfSecondRank="0.0" support="82" priorScore="6.820778213196665E-7" finalScore="1.0" types=""/>
  </surfaceForm>
  <surfaceForm name="comparing" offset="63">
    <resource label="Historical linguistics" uri="Historical_linguistics" contextualScore="0.34884815779211076" percentageOfSecondRank="0.01973909517167119" support="616" priorScore="5.123901682108714E-6" finalScore="0.2940874278433742" types=""/>
    <resource label="Comparative linguistics" uri="Comparative_linguistics" contextualScore="0.6337381562590199" percentageOfSecondRank="0.4201784312765022" support="269" priorScore="2.2375479748169547E-6" finalScore="0.6999108139604799" types=""/>
  </surfaceForm>
  <surfaceForm name="intuitive" offset="180">
    <resource label="Intuition (psychology)" uri="Intuition_(psychology)" contextualScore="0.9999999962028596" percentageOfSecondRank="1.6937092341525003E-11" support="428" priorScore="3.560113506400211E-6" finalScore="0.9999999999830607" types=""/>
  </surfaceForm>
  <surfaceForm name="Similarity" offset="94">
    <resource label="Similarity (geometry)" uri="Similarity_(geometry)" contextualScore="0.8067480719915441" percentageOfSecondRank="0.040228817310750134" support="262" priorScore="2.179321819338447E-6" finalScore="0.9613269534862886" types=""/>
  </surfaceForm>
  <surfaceForm name="ML" offset="506">
    <resource label="ML (programming language)" uri="ML_(programming_language)" contextualScore="0.9970789167035435" percentageOfSecondRank="3.571304635353677E-5" support="154" priorScore="1.2809754205271786E-6" finalScore="0.9999636976781566" types="Schema:CreativeWork, DBpedia:Work, DBpedia:Software, DBpedia:ProgrammingLanguage"/>
  </surfaceForm>
  <surfaceForm name="dopamine D3 receptor" offset="767">
    <resource label="Dopamine receptor D3" uri="Dopamine_receptor_D3" contextualScore="0.9999999999996589" percentageOfSecondRank="0.0" support="75" priorScore="6.238516658411584E-7" finalScore="1.0" types="DBpedia:Biomolecule, DBpedia:Protein"/>
  </surfaceForm>
  <surfaceForm name="appealing" offset="111">
    <resource label="Appeal" uri="Appeal" contextualScore="0.0014549412535160122" percentageOfSecondRank="6.384294107353045E-5" support="2319" priorScore="1.9289493507808618E-5" finalScore="0.19303623265927106" types=""/>
    <resource label="Attractiveness" uri="Attractiveness" contextualScore="0.9985409656919847" percentageOfSecondRank="0.23921690297140083" support="113" priorScore="9.399365098673453E-7" finalScore="0.8069506387780181" types=""/>
  </surfaceForm>
  <surfaceForm name="general" offset="573">
    <resource label="General relativity" uri="General_relativity" contextualScore="0.9999999978200549" percentageOfSecondRank="2.7044528717852594E-8" support="3062" priorScore="2.5469784010741693E-5" finalScore="0.9999999713727452" types=""/>
  </surfaceForm>
  <surfaceForm name="hopping" offset="399">
    <resource label="Frequency-hopping spread spectrum" uri="Frequency-hopping_spread_spectrum" contextualScore="0.9977359933975603" percentageOfSecondRank="0.039422899629906874" support="113" priorScore="9.399365098673453E-7" finalScore="0.9587723811617506" types=""/>
  </surfaceForm>
  <surfaceForm name="An" offset="905">
    <resource label="English articles" uri="English_articles" contextualScore="0.9075745787833807" percentageOfSecondRank="0.00999106970368449" support="5094" priorScore="4.237200514393148E-5" finalScore="0.9890889354939489" types=""/>
  </surfaceForm>
  <surfaceForm name="scaffold" offset="390">
    <resource label="Tissue engineering" uri="Tissue_engineering" contextualScore="0.7354824532680985" percentageOfSecondRank="0.003802903353495458" support="237" priorScore="1.9713712640580605E-6" finalScore="0.130412215591329" types=""/>
    <resource label="Scaffolding" uri="Scaffolding" contextualScore="0.19630753059227468" percentageOfSecondRank="0.1500659399406103" support="427" priorScore="3.5517954841889952E-6" finalScore="0.8690327441586054" types=""/>
  </surfaceForm>
  <surfaceForm name="types" offset="161">
    <resource label="Data type" uri="Data_type" contextualScore="0.9831254216967044" percentageOfSecondRank="7.831626780445169E-4" support="1375" priorScore="1.1437280540421237E-5" finalScore="0.9992120296590611" types=""/>
  </surfaceForm>
  <surfaceForm name="probability" offset="685">
    <resource label="Probability" uri="Probability" contextualScore="0.8121257739848846" percentageOfSecondRank="5.2255137167878523E-5" support="4712" priorScore="3.919452065924718E-5" finalScore="0.9999047347410933" types=""/>
  </surfaceForm>
  <surfaceForm name="machine-learning" offset="488">
    <resource label="Machine learning" uri="Machine_learning" contextualScore="1.0" percentageOfSecondRank="0.0" support="1045" priorScore="8.69233321072014E-6" finalScore="1.0" types=""/>
  </surfaceForm>
  <surfaceForm name="predicted" offset="675">
    <resource label="Prediction" uri="Prediction" contextualScore="0.9998791085168403" percentageOfSecondRank="7.041366088852746E-7" support="462" priorScore="3.842926261581536E-6" finalScore="0.999999291917357" types=""/>
  </surfaceForm>
  <surfaceForm name="ligands" offset="788">
    <resource label="Ligand" uri="Ligand" contextualScore="0.9998732695084199" percentageOfSecondRank="3.755128697975665E-6" support="2870" priorScore="2.3872723746188327E-5" finalScore="0.9999962448854395" types=""/>
  </surfaceForm>
  <surfaceForm name="methods" offset="864">
    <resource label="Scientific method" uri="Scientific_method" contextualScore="0.9952945148218585" percentageOfSecondRank="0.005966206393071742" support="1645" priorScore="1.3683146537449409E-5" finalScore="0.9907181147817515" types=""/>
  </surfaceForm>
  <surfaceForm name="fingerprints" offset="825">
    <resource label="Cryptographic hash function" uri="Cryptographic_hash_function" contextualScore="0.9993468304913699" percentageOfSecondRank="0.05713216187416136" support="494" priorScore="4.10910297234043E-6" finalScore="0.9448566260417547" types=""/>
  </surfaceForm>
  <surfaceForm name="random forests" offset="873">
    <resource label="Random forest" uri="Random_forest" contextualScore="1.0" percentageOfSecondRank="0.0" support="28" priorScore="2.3290462191403247E-7" finalScore="1.0" types=""/>
  </surfaceForm>
  <surfaceForm name="partially" offset="315">
    <resource label="Partial derivative" uri="Partial_derivative" contextualScore="0.9999999999272404" percentageOfSecondRank="1.7206440359155148E-11" support="460" priorScore="3.826290217159105E-6" finalScore="0.9999999999821512" types=""/>
  </surfaceForm>
</annotation>